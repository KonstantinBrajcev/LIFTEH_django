<h1>Добавить АВР</h1>
<hr>

    <form method="post" action="{% url 'avr_add' pk=object.id %}">
        {% csrf_token %}

    <!-- Скрытые поля -->
    <input type="hidden" name="object" value="{{ object.id }}">
    <input type="hidden" name="insert_date" value="{{ current_datetime|date:'Y-m-d H:i:s' }}">
    <input type="hidden" name="work_id" value="0"> 
    <!-- Скрытые поля -->

    {% comment %} <div class="input-group" hidden>
        <label for="object">Object:</label>
        <input type="text" name="object" id='object' value="{{ object.id }}" readonly>
    </div>
    <div class="input-group" hidden>
        <label for="insert_date">Insert date:</label>
        <input type="text" name="insert_date" value="{{ current_datetime|date:'Y-m-d H:i:s' }}" required id="insert_date">
    </div> {% endcomment %}
  
    <div class="input-group">
        <label class="input-group-text" for="id_problem">Problem:</label>
        <textarea class="form-control" name="problem" maxlength="500" required="" id="id_problem" rows="4"></textarea>
    </div>

    {% comment %} И ЭТО {% endcomment %}
    {% comment %} <input type="hidden" name="work_id" value="{{ avr.work_id|default:'0' }}"> {% endcomment %}
    {% comment %} И это {% endcomment %}

    {% comment %} <div class="input-group" hidden>
        <label for="id_work_id">Work id:</label>
        <input type="text" name="work_id" value="" maxlength="20" id="id_work_id">
    </div> {% endcomment %}

    <h3>Работы:</h3>
    <div id="work-rows">
        <div class="work-row" style="display: flex; gap: 10px; align-items: flex-start; margin-bottom: 10px;">
            <div class="input-group" style="width: 380px;">
                <label class="input-group-text" for="workname">Наименование работ:</label>
                <input class="form-control" type="text" name="workname" maxlength="100" required>
            </div>
            
            <div class="input-group" style="width: 180px;">
                <label class="input-group-text" for="unit">Ед. изм.:</label>
                <select class="form-select" name="unit" required>
                    <option value="шт.">шт.</option>
                    <option value="комп.">комп.</option>
                    <option value="л.">л.</option>
                    <option value="кг.">кг.</option>
                    <option value="м.">м.</option>
                </select>
            </div>

            <div class="input-group" style="width: 180px;">
                <label class="input-group-text" for="quantity">Количество:</label>
                <input class="form-control" type="number" name="quantity" min="1" value="1" style="width: 50px;" required>
            </div>
        </div>
    </div>

    <div>
        <button type="button" class="btn btn-warning" onclick="addWorkRow()">+ Добавить работу</button>
    </div>
    <hr>
        <button type="submit" class="btn btn-success">Сохранить</button>
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Отмена</button>
</form>